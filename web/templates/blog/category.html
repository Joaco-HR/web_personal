{% extends "blog.html" %}
{% load static %}
{% block title %}Categor√≠a: {{ category }} - Blog{% endblock %}

{% block page_content %}
  <div class="category-header" style="background-image: url('{% static 'Portafolio/assets/Fondos/Fondo Azul.png' %}'); background-size: cover; background-position: center;">
    <h2 class="category-title">Categor√≠a: {{ category }}</h2>
    <a href="{% url 'blog:blog_index' %}" class="volver">Volver al Blog</a>
  </div>
    <div class="Barra-busqueda">
    <div class="search-section">
      <form method="get" class="search-form">
        <div class="search-input-group">
          <input type="text" 
                 name="search" 
                 placeholder="Buscar recetas..." 
                 value="{{ request.GET.search }}"
                 class="search-input"
                 maxlength="100">
          <button type="submit" class="search-button">
            üîç
          </button>
        </div>
      </form>
      {% if request.GET.search %}
        <div class="search-results-info">
          <p>Resultados en "{{ category }}" para: "<strong>{{ request.GET.search }}</strong>"</p>
          <a href="{% url 'blog:blog_category' category %}" class="clear-search">Limpiar b√∫squeda</a>
        </div>
      {% endif %}
    </div>
  </div>
  <div class="Posteos">
    {% for post in posts %}
      <article class="Tarjeta" style="background-image: url('{% static 'Portafolio/assets/Fondos/Fondo Blanco.png' %}'); background-size: cover; background-position: center;">
        <div class="Contenido">
          <h2 class="titulo-posteo">
            <a href="{% url 'blog:blog_detail' post.pk %}">{{ post.title }}</a>
          </h2>
          {% if post.image %}
            <div class="post-image">
              <img src="{{ post.image.url }}" alt="{{ post.title }}" class="post-thumbnail">
            </div>
          {% endif %}
          <div class="info">
            <span class="post-date">{{ post.created_on.date }}</span>
            <span class="separator">|</span>
            <span class="post-categories">Categor√≠as:
              {% for category in post.categories.all %}
                <a href="{% url 'blog:blog_category' category.name %}" class="categoria">
                  {{ category.name }}
                </a>{% if not forloop.last %}, {% endif %}
              {% endfor %}
            </span>
          </div>
          
          <div class="informacion-previa">
            <p>{{ post.body | slice:":300" }}{% if post.body|length > 300 %}...{% endif %}</p>
          </div>
          
          <a href="{% url 'blog:blog_detail' post.pk %}" class="leer-mas">Leer m√°s</a>
        </div>
      </article>
    {% empty %}
      <div class="no-posts" style="background-image: url('{% static 'Portafolio/assets/Fondos/Fondo Blanco.png' %}'); background-size: cover; background-position: center;">
        <h3>No hay posts en esta categor√≠a</h3>
        <p>Pronto habr√° contenido en esta categor√≠a.</p>
      </div>
    {% endfor %}
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function() {  
    const logo = document.querySelector('.Barra ul li a img'); 
    const subir = document.querySelector('.boton-subir img');
    logo.src = "{% static 'Portafolio/assets/Logos/Portafolio(blog).png' %}";
    subir.src = "{% static 'Portafolio/assets/Logos/Subir(blog).png' %}";
});
</script>
{% endblock page_content %}